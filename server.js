!function(e){var o={};function t(s){if(o[s])return o[s].exports;var n=o[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=o,t.d=function(e,o,s){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var n in e)t.d(s,n,function(o){return e[o]}.bind(null,n));return s},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=10)}([function(module,exports,__webpack_require__){"use strict";var evalAllowed=!1;try{eval("evalAllowed = true")}catch(e){}var platformSupported=!!Object.setPrototypeOf&&evalAllowed;module.exports=__webpack_require__(12)},function(e,o){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,o){e.exports=require("express")},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(19),u="mongodb://guest:1234@ds125288.mlab.com:25288/mlabdb",c="b7Q6sPdVHJDB4TTehG1dOyyDAdm2TV1JUscXc9XHOe5T7w4blV",a="AIzaSyC8K66Hs3IKMTnrdhTH3OvKkgOnC11oEIU",i="AIzaSyC8K66Hs3IKMTnrdhTH3OvKkgOnC11oEIU",l=new r.OAuth("https://twitter.com/oauth/request_token","https://twitter.com/oauth/access_token","mqMuivEEFDyBNekQBk56PMMSa",c,"1.0A","http://localhost:3000/auth","HMAC-SHA1"),g=new r.OAuth2("mqMuivEEFDyBNekQBk56PMMSa",c,"https://api.twitter.com/",null,"oauth2/token",null);e.exports={twitterConsumerKey:"mqMuivEEFDyBNekQBk56PMMSa",twitterConsumerSecret:c,consumer:l,consumer2:g,placekey:a,geokey:i,mongourl:u,db:"mlabdb",collection:"gulyanka-db"},s=t(0).default,n=t(0).leaveModule,s&&(s.register(u,"_mongourl","/mnt/c/Work/gulyanka/src/utils.js"),s.register("mqMuivEEFDyBNekQBk56PMMSa","_twitterConsumerKey","/mnt/c/Work/gulyanka/src/utils.js"),s.register(c,"_twitterConsumerSecret","/mnt/c/Work/gulyanka/src/utils.js"),s.register(a,"_placekey","/mnt/c/Work/gulyanka/src/utils.js"),s.register(i,"_geokey","/mnt/c/Work/gulyanka/src/utils.js"),s.register("mlabdb","_db","/mnt/c/Work/gulyanka/src/utils.js"),s.register("gulyanka-db","_collection","/mnt/c/Work/gulyanka/src/utils.js"),s.register(l,"_consumer","/mnt/c/Work/gulyanka/src/utils.js"),s.register(g,"_consumer2","/mnt/c/Work/gulyanka/src/utils.js"),n(e))}).call(this,t(1)(e))},function(e,o){e.exports=require("request")},function(e,o){e.exports=require("express-session")},function(e,o){e.exports=require("mongodb")},function(e,o){e.exports=require("util-inspect")},function(e,o){e.exports=require("assert")},function(e,o){e.exports=require("path")},function(e,o,t){e.exports=t(11)},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s=t(2),n=(t(9),t(14)),r=(t(15),t(16)),u=t(5),c=t(17),a=t(18)(u),i=t(3),l=s();l.use(n("dev")),l.use(r.json()),l.use(r.urlencoded({extended:!0})),l.set("trust proxy",!0),l.use(u({secret:"keyboard cat",cookie:{secure:!1,expires:new Date(2534023e8)},store:new a({url:i.mongourl}),proxy:!0,resave:!0,saveUninitialized:!0})),l.use("/api/getplaces",t(20)),l.use("/api/getphoto",t(22)),l.use("/api/getdetails",t(23)),l.use("/api/auth",t(24)),l.use("/api/auth2",t(25)),l.use("/api/access",t(26)),l.use("/api/verify",t(27)),l.use("/api/callback",t(28)),l.use("/api/willgo",t(29)),l.use("/api/getgoers",t(30)),l.use(c()),l.use(s.static("public"));var g,p,f=process.env.PORT||3e3;l.listen(f,function(){console.log("Listening on port: "+f)}),g=t(0).default,p=t(0).leaveModule,g&&(g.register(a,"MongoStore","/mnt/c/Work/gulyanka/src/server.prod.js"),g.register(l,"app","/mnt/c/Work/gulyanka/src/server.prod.js"),g.register(f,"port_number","/mnt/c/Work/gulyanka/src/server.prod.js"),p(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s,n=(s=t(13))&&"object"==typeof s&&"default"in s?s.default:s,r=function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")},u=function(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o},c=function(e){function o(){return r(this,o),u(this,e.apply(this,arguments))}return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}(o,e),o.prototype.render=function(){return n.Children.only(this.props.children)},o}(n.Component);o.AppContainer=c,o.hot=function(){return function(e){return e}},o.areComponentsEqual=function(e,o){return e===o},o.setConfig=function(){},o.cold=function(e){return e},o.configureComponent=function(){}},function(e,o){e.exports=require("react")},function(e,o){e.exports=require("morgan")},function(e,o){e.exports=require("cookie-parser")},function(e,o){e.exports=require("body-parser")},function(e,o){e.exports=require("connect-history-api-fallback")},function(e,o){e.exports=require("connect-mongo")},function(e,o){e.exports=require("oauth")},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=t(4),c=t(21),a=t(6).MongoClient,i=t(3);r.get("/",function(e,o,t){if(""!=e.query.city){var s="https://maps.googleapis.com/maps/api/geocode/json?address="+c.encode(e.query.city)+"&key="+i.geokey;u(s,function(e,t,n){if(200===t.statusCode&&"OK"===JSON.parse(n).status){console.log("geocode: OK");var r=JSON.parse(n).results[0].geometry.location.lng,c=JSON.parse(n).results[0].geometry.location.lat;s="https://maps.googleapis.com/maps/api/place/nearbysearch/json?location="+(c+","+r)+"&radius=500&type=bar&key="+i.placekey,u(s,function(e,t,s){if(e)throw console.log("places: ERROR"),console.log(e),e;console.log("places: OK"),o.end(s)})}else console.log("geocode: ERROR"),console.log(JSON.parse(n).status),o.end(n)})}else o.end(JSON.stringify({status:"NO_INPUT"}))}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getplaces.js"),s.register(a,"mongo","/mnt/c/Work/gulyanka/src/routes/api/getplaces.js"),n(e))}).call(this,t(1)(e))},function(e,o){e.exports=require("utf8")},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=t(4),c=t(6).MongoClient,a=t(8),i=t(3);r.get("/",function(e,o){var t=e.query.photoref,s=e.query.placeref;c.connect(i.mongourl,{useNewUrlParser:!0},function(e,n){a.equal(e,null);var r=n.db(i.db);r.collection("gulyanka-imgs").findOne({placeref:s},function(e,c){if(a.equal(e,null),null!=c)o.end(JSON.stringify(c.href)),n.close();else{var l="https://maps.googleapis.com/maps/api/place/photo?maxwidth=500&photoreference="+t+"&key="+i.geokey;u(l,function(e,t,u){var c=t.request.uri.href;c.includes("https://maps.googleapis.com/maps/api/place")?(console.log("photo: OVER_QUOTA"),o.end("muh shekels")):(console.log("photo: OK"),o.end(JSON.stringify(c)),r.collection("gulyanka-imgs").findOneAndUpdate({placeref:s},{$set:{href:c}},{upsert:!0},function(e,o){a.equal(e,null),n.close()}))})}})})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getphoto.js"),s.register(c,"mongo","/mnt/c/Work/gulyanka/src/routes/api/getphoto.js"),n(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=t(4),c=t(3);r.get("/",function(e,o,t){var s=e.query.placeid,n=(e.query.photoref,"https://maps.googleapis.com/maps/api/place/details/json?placeid="+s+"&key="+c.geokey);u(n,function(e,t,s){var n={details:s=JSON.parse(s),status:s.status};o.end(JSON.stringify(n))})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getdetails.js"),s.register("1200","maxwidth","/mnt/c/Work/gulyanka/src/routes/api/getdetails.js"),n(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=(t(4),t(3)),c=(t(5),t(7));r.get("/",function(e,o,t){console.log("------------------------"),console.log("getting request tokens..."),u.consumer.getOAuthRequestToken(function(t,s,n,r){t?(console.log(c(t)),o.status(500).json({message:"ERROR",error:t})):(e.session.reqToken=s,e.session.reqTokenSecret=n,e.session.auth="user",console.log("------------------------"),console.log("<<"+e.session.reqToken),console.log("<<"+e.session.reqTokenSecret),console.log("sessionID: "+e.sessionID),o.status(200).json({message:"OK",reqToken:s,reqTokenSecret:n}))})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/auth.js"),n(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=(t(4),t(3)),c=(t(5),t(7));r.get("/",function(e,o,t){null!=e.session.auth?(console.log("------------------------"),console.log("Already authorized (bearer)"),console.log("<<"+e.session.oauth2.access_token),console.log("sessionID: "+e.sessionID),o.status(200).json({message:"OK"})):(console.log("------------------------"),console.log("------------------------"),console.log("req.session.auth: "+e.session.auth),u.consumer2.getOAuthAccessToken("",{grant_type:"client_credentials"},function(t,s,n){t?(console.log(c(t)),o.status(500).json({message:"ERROR",error:t})):(e.session.oauth2={},e.session.oauth2.access_token=s,e.session.auth="bearer",console.log("------------------------"),console.log("Authorized (bearer)"),console.log("<<"+e.session.oauth2.access_token),console.log("sessionID: "+e.sessionID),o.status(200).json({message:"OK"}))}))}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/auth2.js"),n(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=(t(4),t(3)),c=(t(5),t(7));r.get("/",function(e,o,t){console.log("------------------------"),console.log("getting access tokens..."),u.consumer.getOAuthAccessToken(e.session.reqToken,e.session.reqTokenSecret,e.query.oauth_verifier,function(t,s,n,r){t?(o.send("Error getting OAuth access token: "+c(t)),console.log(c(t))):(e.session.accToken=s,e.session.accTokenSecret=n,e.session.verifier=e.query.oauth_verifier,console.log("------------------------"),console.log("accToken: "+s),console.log("accTokenSecret: "+n),o.status(200).end())})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/access.js"),n(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=(t(4),t(3)),c=(t(5),t(7));r.get("/",function(e,o,t){console.log("**-----------------------------------------------------**"),console.log("VERIFIYING FOR : "+e.sessionID),console.log("accToken Session: "+e.session.accToken),console.log("accTokenSecret Session: "+e.session.accTokenSecret),console.log("**-----------------------------------------------------**"),console.log("verifying..."),u.consumer.get("https://api.twitter.com/1.1/account/verify_credentials.json",e.session.accToken,e.session.accTokenSecret,function(t,s,n){if(t)console.log("ERROR: "+c(t)),o.status(403).json({status:403,error:t});else{console.log("----------"),console.log("Success");var r=JSON.parse(s);e.session.data=r,e.session.logged=!0,console.log("----------"),console.log("Getting friends for "+e.session.data.screen_name+"..."),u.consumer.get("https://api.twitter.com/1.1/friends/list.json?cursor=-1&screen_name="+e.session.data.screen_name,e.session.accToken,e.session.accTokenSecret,function(t,s,n){if(t)console.log("ERROR: "+c(t)),o.status(403).json({status:403,error:t});else{console.log("----------"),console.log("Success");var r=JSON.parse(s);e.session.friends=r,o.status(200).json({status:200,data:e.session.data,friends:e.session.friends})}})}})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/verify.js"),n(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";(function(e,o){var s;(s=t(0).enterModule)&&s(e);var n,r,u=t(2).Router(),c=t(4),a=t(9);u.get("/",function(e,t,s){c.post({url:"https://api.twitter.com/oauth/access_token",oauth:{verifier:e.query.oauth_verifier,token:e.query.oauth_token}},function(e,s,n){return e?t.send(500,{message:e.message}):200!==s.statusCode?t.send(s.statusCode,{message:"Error"}):void t.sendFile(a.resolve(o+"../../../public/redirect.html"))})}),e.exports=u,n=t(0).default,r=t(0).leaveModule,n&&(n.register(u,"router","/mnt/c/Work/gulyanka/src/routes/api/callback.js"),r(e))}).call(this,t(1)(e),"/")},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=t(3),c=t(6).MongoClient,a=t(8);r.get("/",function(e,o,t){console.log("**-----------------------------------------------------**"),console.log("Sumbitting WillGo for user: "+e.session.data.id),console.log("place ID : "+e.query.q),console.log("**-----------------------------------------------------**"),c.connect(u.mongourl,function(o,t){if(o)throw o;t.db(u.db).collection(u.collection).findOneAndUpdate({place_id:e.query.q},{$push:{goers:e.session.data.id}},{upsert:!0},function(e,o){a.equal(e,null),console.log(o),t.close(),console.log("sent :^)")})}),o.status(200).send(JSON.stringify({message:"ok"}))}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/willgo.js"),s.register(c,"mongo","/mnt/c/Work/gulyanka/src/routes/api/willgo.js"),n(e))}).call(this,t(1)(e))},function(e,o,t){"use strict";(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(2).Router(),u=t(6).MongoClient,c=t(3),a=t(8),i=t(4);r.get("/",function(e,o,t){"user"!=e.session.auth&&"bearer"!=e.session.auth?o.status(403).json({message:"NOT_AUTHORIZED"}):u.connect(c.mongourl,{useNewUrlParser:!0},function(t,s){a.equal(t,null),s.db(c.db).collection(c.collection).findOne({place_id:e.query.q},function(t,n){if(a.equal(t,null),null!=n){var r="https://api.twitter.com/1.1/users/lookup.json?user_id="+n.goers.toString();if("user"==e.session.auth)c.consumer.get(r,e.session.accToken,e.session.accTokenSecret,function(e,t){a.equal(e,null),o.status(200).json(JSON.parse(t)),s.close()});else{var u={url:r,headers:{Authorization:"Bearer "+e.session.oauth2.access_token}};i(u,function(e,t,s){var n=JSON.parse(s);o.status(200).json({status:200,message:"OK",goers:n})})}}else o.status(204).json({status:"NOT_FOUND",message:"No such place in database"}),s.close()})})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getgoers.js"),s.register(u,"mongo","/mnt/c/Work/gulyanka/src/routes/api/getgoers.js"),n(e))}).call(this,t(1)(e))}]);
!function(e){var o={};function t(s){if(o[s])return o[s].exports;var n=o[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=o,t.d=function(e,o,s){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var n in e)t.d(s,n,function(o){return e[o]}.bind(null,n));return s},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=28)}([function(module,exports,__webpack_require__){"use strict";var evalAllowed=!1;try{eval("evalAllowed = true")}catch(e){}var platformSupported=!!Object.setPrototypeOf&&evalAllowed;module.exports=__webpack_require__(30)},function(e,o){e.exports=require("express")},function(e,o){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(32),a="mongodb://guest:1234@ds125288.mlab.com:25288/mlabdb",u="b7Q6sPdVHJDB4TTehG1dOyyDAdm2TV1JUscXc9XHOe5T7w4blV",i="AIzaSyC8K66Hs3IKMTnrdhTH3OvKkgOnC11oEIU",c="AIzaSyC8K66Hs3IKMTnrdhTH3OvKkgOnC11oEIU",l=new r.OAuth("https://twitter.com/oauth/request_token","https://twitter.com/oauth/access_token","mqMuivEEFDyBNekQBk56PMMSa",u,"1.0A","http://localhost:3000/api/callback","HMAC-SHA1"),p=new r.OAuth2("mqMuivEEFDyBNekQBk56PMMSa",u,"https://api.twitter.com/",null,"oauth2/token",null);e.exports={twitterConsumerKey:"mqMuivEEFDyBNekQBk56PMMSa",twitterConsumerSecret:u,consumer:l,consumer2:p,placekey:i,geokey:c,mongourl:a,db:"mlabdb",collection:"gulyanka-db"},s=t(0).default,n=t(0).leaveModule,s&&(s.register(a,"_mongourl","/mnt/c/Work/gulyanka/src/utils.js"),s.register("mqMuivEEFDyBNekQBk56PMMSa","_twitterConsumerKey","/mnt/c/Work/gulyanka/src/utils.js"),s.register(u,"_twitterConsumerSecret","/mnt/c/Work/gulyanka/src/utils.js"),s.register(i,"_placekey","/mnt/c/Work/gulyanka/src/utils.js"),s.register(c,"_geokey","/mnt/c/Work/gulyanka/src/utils.js"),s.register("mlabdb","_db","/mnt/c/Work/gulyanka/src/utils.js"),s.register("gulyanka-db","_collection","/mnt/c/Work/gulyanka/src/utils.js"),s.register(l,"_consumer","/mnt/c/Work/gulyanka/src/utils.js"),s.register(p,"_consumer2","/mnt/c/Work/gulyanka/src/utils.js"),n(e))}).call(this,t(2)(e))},function(e,o){e.exports=require("request")},function(e,o){e.exports=require("express-session")},function(e,o){e.exports=require("path")},function(e,o){e.exports=require("mongodb")},function(e,o){e.exports=require("util-inspect")},function(e,o){e.exports=require("assert")},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=(t(4),t(3)),u=(t(5),t(8));r.get("/",function(e,o,t){"bearer"==e.session.auth||"user"==e.session.auth?t():(console.log("------------------------"),console.log("AUTHORIZING APP..."),a.consumer2.getOAuthAccessToken("",{grant_type:"client_credentials"},function(s,n,r){s?(console.log(u(s)),o.status(500).json({message:"ERROR",error:s})):(e.session.oauth2={},e.session.oauth2.bearer_token=n,e.session.auth="bearer",console.log("------------------------"),console.log("Authorized (bearer)"),console.log("<<"+e.session.oauth2.bearer_token),console.log("sessionID: "+e.sessionID),t())}))}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/auth2.js"),n(e))}).call(this,t(2)(e))},function(e,o){e.exports=require("morgan")},function(e,o){e.exports=require("cookie-parser")},function(e,o){e.exports=require("body-parser")},function(e,o){e.exports=require("connect-history-api-fallback")},function(e,o){e.exports=require("connect-mongo")},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=t(4),u=t(33),i=t(7).MongoClient,c=t(3);r.get("/",function(e,o,t){if(""!=e.query.city){var s="https://maps.googleapis.com/maps/api/geocode/json?address="+u.encode(e.query.city)+"&key="+c.geokey;a(s,function(e,t,n){if(200===t.statusCode&&"OK"===JSON.parse(n).status){console.log("geocode: OK");var r=JSON.parse(n).results[0].geometry.location.lng,u=JSON.parse(n).results[0].geometry.location.lat;s="https://maps.googleapis.com/maps/api/place/nearbysearch/json?location="+(u+","+r)+"&radius=500&type=bar&key="+c.placekey,a(s,function(e,t,s){if(e)throw console.log("places: ERROR"),console.log(e),e;console.log("places: OK"),o.end(s)})}else console.log("geocode: ERROR"),console.log(JSON.parse(n).status),o.end(n)})}else o.end(JSON.stringify({status:"NO_INPUT"}))}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getplaces.js"),s.register(i,"mongo","/mnt/c/Work/gulyanka/src/routes/api/getplaces.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=t(4),u=t(7).MongoClient,i=t(9),c=t(3);r.get("/",function(e,o){var t=e.query.photoref,s=e.query.placeref;u.connect(c.mongourl,{useNewUrlParser:!0},function(e,n){i.equal(e,null);var r=n.db(c.db);r.collection("gulyanka-imgs").findOne({placeref:s},function(e,u){if(i.equal(e,null),null!=u)o.end(JSON.stringify(u.href)),n.close();else{var l="https://maps.googleapis.com/maps/api/place/photo?maxwidth=1500&photoreference="+t+"&key="+c.geokey;a(l,function(e,t,a){var u=t.request.uri.href;u.includes("https://maps.googleapis.com/maps/api/place")?(console.log("photo: OVER_QUOTA"),o.end("muh shekels")):(console.log("photo: OK"),o.end(JSON.stringify(u)),r.collection("gulyanka-imgs").findOneAndUpdate({placeref:s},{$set:{href:u}},{upsert:!0},function(e,o){i.equal(e,null),n.close()}))})}})})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getphoto.js"),s.register(u,"mongo","/mnt/c/Work/gulyanka/src/routes/api/getphoto.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=t(4),u=t(3);r.get("/",function(e,o,t){var s=e.query.placeid,n=(e.query.photoref,"https://maps.googleapis.com/maps/api/place/details/json?placeid="+s+"&key="+u.geokey);a(n,function(e,t,s){var n={details:s=JSON.parse(s),status:s.status};o.end(JSON.stringify(n))})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getdetails.js"),s.register("1200","maxwidth","/mnt/c/Work/gulyanka/src/routes/api/getdetails.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=(t(4),t(3)),u=(t(5),t(8));r.get("/",function(e,o,t){console.log("------------------------"),console.log("getting request tokens..."),a.consumer.getOAuthRequestToken(function(t,s,n,r){if(t)console.log(u(t)),o.status(500).json({message:"ERROR",error:t});else{e.session.oauth={},e.session.oauth.reqToken=s,e.session.oauth.reqTokenSecret=n,console.log("------------------------"),console.log("<<"+e.session.oauth.reqToken),console.log("<<"+e.session.oauth.reqTokenSecret),console.log("sessionID: "+e.sessionID);var a="https://api.twitter.com/oauth/authenticate?oauth_token=".concat(e.session.oauth.reqToken);console.log(a),o.redirect(a)}})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/auth.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=(t(4),t(3)),u=(t(5),t(8));r.get("/",function(e,o,t){console.log("------------------------"),console.log("getting access tokens..."),a.consumer.getOAuthAccessToken(e.session.reqToken,e.session.reqTokenSecret,e.query.oauth_verifier,function(t,s,n,r){t?(o.send("Error getting OAuth access token: "+u(t)),console.log(u(t))):(e.session.accToken=s,e.session.accTokenSecret=n,e.session.verifier=e.query.oauth_verifier,console.log("------------------------"),console.log("accToken: "+s),console.log("accTokenSecret: "+n),o.status(200).end())})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/access.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){"use strict";t.r(o),function(e,o){var s,n=t(27);(s=t(0).enterModule)&&s(e);var r,a,u=t(1).Router(),i=(t(4),t(3)),c=(t(5),t(8)),l=t(6);u.get("/",function(e,t,s){console.log("**-----------------------------------------------------**"),console.log("VERIFIYING FOR : "+e.sessionID),console.log("accToken Session: "+e.session.oauth.accToken),console.log("accTokenSecret Session: "+e.session.oauth.accTokenSecret),console.log("**-----------------------------------------------------**"),console.log("verifying..."),i.consumer.get("https://api.twitter.com/1.1/account/verify_credentials.json",e.session.oauth.accToken,e.session.oauth.accTokenSecret,function(s,r,a){if(s)console.log("ERROR: "+c(s)),t.status(403).json({status:403,error:s});else{console.log("----------"),console.log("Success");var u=JSON.parse(r);e.session.oauth.data=u,e.session.auth="user",console.log("----------"),console.log("Getting friends for ".concat(e.session.oauth.data.screen_name,"...")),i.consumer.get("https://api.twitter.com/1.1/friends/list.json?cursor=-1&screen_name="+e.session.oauth.data.screen_name,e.session.oauth.accToken,e.session.oauth.accTokenSecret,function(s,r,a){if(!s){console.log("----------"),console.log("Success");var u=JSON.parse(r);return e.session.oauth.friends=u,n.a.send({status:200,data:e.session.oauth.data,friends:e.session.oauth.friends}),t.status(200).sendFile(l.join(o+"../../../public/redirect_close.html"))}console.log("ERROR: "+c(s)),t.status(403).json({status:403,error:s})})}})}),e.exports=u,r=t(0).default,a=t(0).leaveModule,r&&(r.register(u,"router","/mnt/c/Work/gulyanka/src/routes/api/verify.js"),a(e))}.call(this,t(22)(e),"/")},function(e,o){e.exports=function(e){if(!e.webpackPolyfill){var o=Object.create(e);o.children||(o.children=[]),Object.defineProperty(o,"loaded",{enumerable:!0,get:function(){return o.l}}),Object.defineProperty(o,"id",{enumerable:!0,get:function(){return o.i}}),Object.defineProperty(o,"exports",{enumerable:!0}),o.webpackPolyfill=1}return o}},function(e,o){e.exports=require("webpack")},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=t(4);r.get("/",function(e,o,t){a.post({url:"https://api.twitter.com/oauth/access_token",oauth:{verifier:e.query.oauth_verifier,token:e.query.oauth_token}},function(t,s,n){if(t)return o.send(500,{message:t.message});if(200!==s.statusCode)return o.status(400).json({message:"ERROR"});var r=n.match(/(?<=\boauth_token=)(?:(?!&).)*/g),a=n.match(/(?<=\boauth_token_secret=)(?:(?!&).)*/g);n.match(/(?<=\bscreen_name=)(?:(?!&).)*/g),n.match(/(?<=\buser_id=)(?:(?!&).)*/g);return e.session.oauth.accToken=r,e.session.oauth.accTokenSecret=a,console.log("ACCESS_GRANTED"),o.redirect("/api/verify")})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/callback.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=t(3),u=t(7).MongoClient,i=t(9);r.get("/",function(e,o,t){"user"!=e.session.auth&&o.redirect("/api/auth"),console.log("**-----------------------------------------------------**"),console.log("Sumbitting WillGo for user: "+e.session.oauth.data.screen_name),console.log("place ID : "+e.query.q),console.log("**-----------------------------------------------------**"),u.connect(a.mongourl,function(o,t){if(o)throw o;t.db(a.db).collection(a.collection).findOneAndUpdate({place_id:e.query.q},{$push:{goers:e.session.oauth.data.id}},{upsert:!0},function(e,o){i.equal(e,null),console.log(o),t.close(),console.log("sent :^)")})}),o.status(200).send(JSON.stringify({message:"ok"}))}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/willgo.js"),s.register(u,"mongo","/mnt/c/Work/gulyanka/src/routes/api/willgo.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s,n,r=t(1).Router(),a=t(7).MongoClient,u=t(3),i=t(9),c=t(4);r.get("/",function(e,o,t){"user"!=e.session.auth&&"bearer"!=e.session.auth?o.status(403).json({message:"NOT_AUTHORIZED"}):a.connect(u.mongourl,{useNewUrlParser:!0},function(t,s){i.equal(t,null),s.db(u.db).collection(u.collection).findOne({place_id:e.query.q},function(t,n){if(i.equal(t,null),null!=n){var r=n.goers.toString(),a="https://api.twitter.com/1.1/users/lookup.json?user_id=".concat(r);if("user"==e.session.auth)u.consumer.get(a,e.session.oauth.accToken,e.session.oauth.accTokenSecret,function(e,t){i.equal(e,null),o.status(200).json({status:200,message:"OK",goers:JSON.parse(t)}),s.close()});else{var l={url:a,headers:{Authorization:"Bearer "+e.session.oauth2.bearer_token}};c(l,function(e,t,s){var n=JSON.parse(s);o.status(200).json({status:200,message:"OK",goers:n})})}}else o.status(200).json({status:"404",message:"No such place in database"}),s.close()})})}),e.exports=r,s=t(0).default,n=t(0).leaveModule,s&&(s.register(r,"router","/mnt/c/Work/gulyanka/src/routes/api/getgoers.js"),s.register(a,"mongo","/mnt/c/Work/gulyanka/src/routes/api/getgoers.js"),n(e))}).call(this,t(2)(e))},function(e,o,t){"use strict";(function(e,s){var n;t.d(o,"a",function(){return d}),(n=t(0).enterModule)&&n(e);var r=t(1),a=t(6),u=t(11),i=(t(12),t(13)),c=t(5),l=t(14),p=t(15)(c),g=t(34),f=t(3),d=new g(["nothing here"]),m=t(23),h=t(35),k=t(36),y=t(38),v=m(k),b=r();b.use(u("dev")),b.use(i.json()),b.use(i.urlencoded({extended:!0})),b.set("trust proxy",!0),b.use(c({secret:"keyboard cat",cookie:{secure:!1,expires:new Date(2534023e8)},store:new p({url:f.mongourl}),proxy:!0,resave:!0,saveUninitialized:!0})),b.use("*",t(10)),b.use("/api/getplaces",t(16)),b.use("/api/getphoto",t(17)),b.use("/api/getdetails",t(18)),b.use("/api/auth",t(19)),b.use("/api/auth2",t(10)),b.use("/api/access",t(20)),b.use("/api/verify",t(21)),b.use("/api/callback",t(24)),b.use("/api/willgo",t(25)),b.use("/api/getgoers",t(26)),b.get("/api/authsse",d.init),b.use(l()),b.use(r.static(a.join(s,"/public"))),b.use(h(v,{noInfo:!0,publicPath:"/"})),b.use(y(v));var O,j,_=process.env.PORT||3e3;b.listen(_,function(){console.log("Listening on port: "+_)}),O=t(0).default,j=t(0).leaveModule,O&&(O.register(p,"MongoStore","/mnt/c/Work/gulyanka/src/server.js"),O.register(d,"sse","/mnt/c/Work/gulyanka/src/server.js"),O.register(v,"compiler","/mnt/c/Work/gulyanka/src/server.js"),O.register(b,"app","/mnt/c/Work/gulyanka/src/server.js"),O.register(_,"port_number","/mnt/c/Work/gulyanka/src/server.js"),j(e))}).call(this,t(22)(e),"/")},function(e,o,t){e.exports=t(29)},function(e,o,t){(function(e){var o;(o=t(0).enterModule)&&o(e);var s=t(1),n=(t(6),t(11)),r=(t(12),t(13)),a=t(5),u=t(14),i=t(15)(a),c=t(3),l=s();l.use(n("dev")),l.use(r.json()),l.use(r.urlencoded({extended:!0})),l.set("trust proxy",!0),l.use(a({secret:"keyboard cat",cookie:{secure:!1,expires:new Date(2534023e8)},store:new i({url:c.mongourl}),proxy:!0,resave:!0,saveUninitialized:!0})),l.use("/api/getplaces",t(16)),l.use("/api/getphoto",t(17)),l.use("/api/getdetails",t(18)),l.use("/api/auth",t(19)),l.use("/api/auth2",t(10)),l.use("/api/access",t(20)),l.use("/api/verify",t(21)),l.use("/api/callback",t(24)),l.use("/api/willgo",t(25)),l.use("/api/getgoers",t(26)),l.use(u()),l.use(s.static("public"));var p,g,f=process.env.PORT||3e3;l.listen(f,function(){console.log("Listening on port: "+f)}),p=t(0).default,g=t(0).leaveModule,p&&(p.register(i,"MongoStore","/mnt/c/Work/gulyanka/src/server.prod.js"),p.register(l,"app","/mnt/c/Work/gulyanka/src/server.prod.js"),p.register(f,"port_number","/mnt/c/Work/gulyanka/src/server.prod.js"),g(e))}).call(this,t(2)(e))},function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s,n=(s=t(31))&&"object"==typeof s&&"default"in s?s.default:s,r=function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")},a=function(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o},u=function(e){function o(){return r(this,o),a(this,e.apply(this,arguments))}return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}(o,e),o.prototype.render=function(){return n.Children.only(this.props.children)},o}(n.Component);o.AppContainer=u,o.hot=function(){return function(e){return e}},o.areComponentsEqual=function(e,o){return e===o},o.setConfig=function(){},o.cold=function(e){return e},o.configureComponent=function(){}},function(e,o){e.exports=require("react")},function(e,o){e.exports=require("oauth")},function(e,o){e.exports=require("utf8")},function(e,o){e.exports=require("express-sse")},function(e,o){e.exports=require("webpack-dev-middleware")},function(e,o,t){(function(o){var s=t(23),n=t(37),r=t(6);e.exports={mode:"development",optimization:{minimize:!1},entry:["webpack-hot-middleware/client","./client/index.js"],output:{path:r.join(o,"dist"),filename:"bundle.js"},module:{rules:[{test:/\.js$/,use:"babel-loader",exclude:/node_modules/},{test:/\.html$/,use:[{loader:"html-loader"}]},{test:/\.css$/,use:["style-loader","css-loader"]},{test:/\.scss$/,use:[{loader:"style-loader"},{loader:"css-loader",options:{sourceMap:!0}},{loader:"sass-loader",options:{sourceMap:!0}}]},{test:/\.(woff(2)?|ttf|eot|svg)(\?v=\d+\.\d+\.\d+)?$/,use:[{loader:"file-loader",options:{name:"[name].[ext]",outputPath:"fonts/"}}]}]},plugins:[new n({template:"client/index.html",filename:"./index.html"}),new s.optimize.OccurrenceOrderPlugin,new s.HotModuleReplacementPlugin,new s.NoEmitOnErrorsPlugin,new s.DefinePlugin({"process.env":{NODE_ENV:JSON.stringify("development")}})]}}).call(this,"/")},function(e,o){e.exports=require("html-webpack-plugin")},function(e,o){e.exports=require("webpack-hot-middleware")}]);